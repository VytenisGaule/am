{% extends "base.html" %}
{% block content %}
<style>
  table.track-targets {
    border-collapse: collapse;
    width: 100%;
  }

  table.track-targets th,
  table.track-targets td {
    border: 1px solid #ddd;
    padding: 8px;
  }

  table.track-targets th {
    background-color: #f2f2f2;
    font-weight: bold;
  }
</style>
<h2>Tracked objects for
  <a href="{% url 'server_endpoint' pk=player_game_server.id %}">
    {{ player_game_server.game_server.name }}
  </a> server:
</h2>
<table class="track-targets">
  <thead>
    <tr>
      <th>Keyword</th>
      <th>Link</th>
      <th>Iterator Value</th>
      <th>Remove tracking obj</th>
      <th>Set conditions</th>
    </tr>
  </thead>
  <tbody>
    {% if track_targets %}
      {% for tracking_obj in track_targets %}
        <tr>
          <td>
            <a href="{% url 'condition_list_endpoint' player_game_server_id=player_game_server.id track_target_id=tracking_obj.id %}">{{ tracking_obj.keyword }}</a>
          </td>
          <td>{{ tracking_obj.link }}</td>
          <td>{{ tracking_obj.iterator_value }}</td>
          <td>
            <form method="POST" action="{% url 'server_trackers_endpoint' player_game_server_id=player_game_server.id %}">
              {% csrf_token %}
              <input type="hidden" name="delete_pk" value="{{ tracking_obj.pk }}">
              <button type="submit" class="delete-button btn-outline-danger">Delete</button>
            </form>
          </td>
            <td>
              <form method="POST" action="{% url 'add_condition_endpoint' player_game_server_id=player_game_server.id track_target_id=tracking_obj.pk %}">
                {% csrf_token %}
                <input type="hidden" name="track_target_id" value="{{ tracking_obj.pk }}">
                {{ form.operator }}
                <button type="submit" class="create-button btn-outline-success">Add condition</button>
              </form>
            </td>
        </tr>
      {% endfor %}
    {% else %}
      <tr>
        <td colspan="3">No tracking objects are set</td>
      </tr>
    {% endif %}
  </tbody>
</table>
<hr>
  <button type="button" class="btn-outline-dark" onclick="window.location.href='{% url 'new_tracking_object_endpoint' player_game_server_id=player_game_server.id %}'">
    Add tracking object
  </button>
  <button type="button" class="btn-outline-success" onclick="window.location.href='{% url 'start_tracking_endpoint' player_game_server_id=player_game_server.id %}'">
    Start tracking
  </button>
  <button type="button" class="btn-outline-danger" onclick="window.location.href='{% url 'stop_tracking_endpoint' player_game_server_id=player_game_server.id %}'">
    Stop tracking
  </button>
{% endblock %}
